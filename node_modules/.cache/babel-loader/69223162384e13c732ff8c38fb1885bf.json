{"ast":null,"code":"import _slicedToArray from\"/Users/mukesh-8058/Desktop/CRM/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import AuthContext from'./AuthContext';import{jsx as _jsx}from\"react/jsx-runtime\";export var AuthContextProvider=function AuthContextProvider(props){var _useState=useState(localStorage.getItem('token')),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];var _useState3=useState(localStorage.getItem(\"userId\")),_useState4=_slicedToArray(_useState3,2),userId=_useState4[0],setUserId=_useState4[1];var _useState5=useState(localStorage.getItem(\"orgId\")),_useState6=_slicedToArray(_useState5,2),orgId=_useState6[0],setOrgId=_useState6[1];var _useState7=useState(localStorage.getItem(\"iat\")),_useState8=_slicedToArray(_useState7,2),iat=_useState8[0],setIat=_useState8[1];var _useState9=useState(localStorage.getItem(\"expAt\")),_useState10=_slicedToArray(_useState9,2),expAt=_useState10[0],setExpAt=_useState10[1];var signOutHandler=function signOutHandler(){localStorage.removeItem(\"token\");localStorage.removeItem(\"userId\");localStorage.removeItem(\"orgId\");localStorage.removeItem(\"expAt\");localStorage.removeItem(\"iat\");};var signInHandler=function signInHandler(_ref){var token=_ref.token,userId=_ref.userId,orgId=_ref.orgId;var currentTime=new Date().getTime();var expiryTime=currentTime+86400000;setToken(token);setUserId(userId);setOrgId(orgId);setIat(currentTime);setExpAt(expiryTime);localStorage.setItem(\"token\",token);localStorage.setItem(\"userId\",userId);localStorage.setItem(\"orgId\",orgId);localStorage.setItem(\"iat\",currentTime);localStorage.setItem(\"expAt\",expiryTime);};if(new Date().getTime()>Number(expAt)&&Number(expAt)!==0){signOutHandler();}else if(new Date().getTime()>iat&&new Date().getTime()<expAt){localStorage.setItem(\"iat\",new Date().getTime());setIat(new Date().getTime());}useEffect(function(){if(iat&&expAt){setTimeout(signOutHandler,Number(expAt)-Number(iat));}},[iat,expAt]);var isLoggedIn=!!token&&!!userId&&!!orgId;var authContext={isLoggedIn:isLoggedIn,token:token,userId:userId,orgId:orgId,signIn:signInHandler,signOut:signOutHandler};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:authContext,children:props.children});};","map":{"version":3,"sources":["/Users/mukesh-8058/Desktop/CRM/src/Store/Auth/AuthStore.js"],"names":["React","useEffect","useState","AuthContext","AuthContextProvider","props","localStorage","getItem","token","setToken","userId","setUserId","orgId","setOrgId","iat","setIat","expAt","setExpAt","signOutHandler","removeItem","signInHandler","currentTime","Date","getTime","expiryTime","setItem","Number","setTimeout","isLoggedIn","authContext","signIn","signOut","children"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport AuthContext from './AuthContext';\n\n\nexport const AuthContextProvider = (props) => {\n    \n    const [token, setToken] = useState(localStorage.getItem('token'));\n    const [userId, setUserId] = useState(localStorage.getItem(\"userId\"));\n    const [orgId, setOrgId] = useState(localStorage.getItem(\"orgId\"));\n    const [iat, setIat] = useState(localStorage.getItem(\"iat\"));\n    const [expAt, setExpAt] = useState(localStorage.getItem(\"expAt\"));\n\n    const signOutHandler = () => {\n        localStorage.removeItem(\"token\");\n        localStorage.removeItem(\"userId\");\n        localStorage.removeItem(\"orgId\");\n        localStorage.removeItem(\"expAt\");\n        localStorage.removeItem(\"iat\");\n    }\n\n    const signInHandler = ({token, userId, orgId}) => {\n        const currentTime = new Date().getTime();\n        const expiryTime = currentTime + 86400000;\n        \n        setToken(token);\n        setUserId(userId);\n        setOrgId(orgId);\n        setIat(currentTime);\n        setExpAt(expiryTime);\n\n        localStorage.setItem(\"token\", token);\n        localStorage.setItem(\"userId\", userId);\n        localStorage.setItem(\"orgId\", orgId);\n        localStorage.setItem(\"iat\", currentTime);\n        localStorage.setItem(\"expAt\", expiryTime);\n        \n    }\n\n    if(new Date().getTime() > Number(expAt) && Number(expAt) !== 0) {\n        signOutHandler();\n    }\n\n     else if(new Date().getTime() > iat && new Date().getTime() < expAt) {\n        localStorage.setItem(\"iat\", new Date().getTime());\n        setIat(new Date().getTime());\n    }\n\n    useEffect(() => {\n        if(iat && expAt) {\n            setTimeout(signOutHandler, Number(expAt) - Number(iat));\n        }\n    },[iat, expAt])\n    const isLoggedIn = !!token && !!userId && !!orgId;\n\n    const authContext = {\n        isLoggedIn,\n        token,\n        userId,\n        orgId,\n        signIn: signInHandler,\n        signOut: signOutHandler \n    }\n\n    return <AuthContext.Provider value={authContext}>{props.children}</AuthContext.Provider>\n}"]},"metadata":{},"sourceType":"module"}